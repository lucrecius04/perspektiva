<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title id="pageTitle">Naƒç√≠t√°m‚Ä¶ | Svƒõt v perspektivƒõ</title>
  <link rel="stylesheet" href="perspektiva-theme.css">
  <script>
    (function(){
      var t = localStorage.getItem('svp-theme');
      var dark = t === 'dark' || (!t && window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
      if (dark) document.documentElement.classList.add('dark');
    })();
  </script>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Serif:wght@400;600;700&family=IBM+Plex+Sans:wght@300;400;500;600&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body {
      font-family: var(--font-sans);
      background: var(--color-bg);
      color: var(--color-text);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      margin: 0;
    }

    /* BREADCRUMB */
    .breadcrumb{font-size:0.82rem;color:var(--color-text-muted);display:flex;gap:0.45rem;align-items:center;margin-bottom:1.5rem;}
    .breadcrumb a{color:var(--color-primary);text-decoration:none;transition:color 0.2s;}
    .breadcrumb a:hover{text-decoration:underline;color:var(--color-primary-hover);}
    .breadcrumb span{opacity:0.6;}

    /* ARTICLE */
    .article-wrapper{max-width:820px;margin:0 auto;padding:1.75rem 2rem 5rem;}
    .article-meta{display:flex;gap:0.5rem;align-items:center;margin-bottom:1.25rem;flex-wrap:wrap;}
    .tag{padding:0.2rem 0.55rem;border-radius:0.2rem;font-size:0.63rem;font-weight:700;text-transform:uppercase;letter-spacing:0.06em;color:white;}
    .article-date{font-family:var(--font-mono);font-size:0.78rem;color:var(--color-text-muted);}

    h1{font-family:var(--font-serif);font-size:2.35rem;font-weight:700;line-height:1.15;margin-bottom:1rem;letter-spacing:-0.02em;}
    .article-lead{font-size:1.12rem;line-height:1.72;color:var(--color-text-muted);margin-bottom:2rem;padding-bottom:1.75rem;border-bottom:2px solid var(--color-border);}

    /* KEY STATS */
    .key-stat-row{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin:2rem 0;}
    .key-stat{background:var(--color-surface);border:1px solid var(--color-border);border-radius:0.5rem;padding:1.1rem;text-align:center;}
    .key-stat-number{font-family:var(--font-mono);font-size:1.85rem;font-weight:700;display:block;margin-bottom:0.3rem;}
    .key-stat-number.good{color:#059669;}
    .key-stat-number.blue{color:var(--color-primary);}
    .key-stat-number.purple{color:#7c3aed;}
    .key-stat-number.bad{color:#dc2626;}
    .key-stat-label{font-size:0.78rem;color:var(--color-text-muted);line-height:1.3;}

    /* ARTICLE BODY */
    .article-body{font-size:1.02rem;line-height:1.78;}
    .article-body h2{font-family:var(--font-serif);font-size:1.5rem;font-weight:700;margin:2rem 0 0.75rem;}
    .article-body p{margin-bottom:1.2rem;}
    .highlight-box{border-left:4px solid;border-radius:0 0.5rem 0.5rem 0;padding:1.1rem 1.4rem;margin:1.5rem 0;font-size:0.98rem;line-height:1.6;}
    .hb-blue{background:var(--color-hero-start);border-color:var(--color-primary);}
    .hb-blue strong{color:#1d4ed8;}
    .hb-green{background:#dcfce7;border-color:#059669;}
    .hb-green strong{color:#15803d;}
    .hb-purple{background:#ede9fe;border-color:#7c3aed;}
    .hb-purple strong{color:#5b21b6;}
    .data-table-wrap{margin:1.5rem 0;overflow-x:auto;}
    table{width:100%;border-collapse:collapse;font-size:0.88rem;}
    th{background:var(--color-text-strong);color:white;text-align:left;padding:0.6rem 0.9rem;font-size:0.75rem;text-transform:uppercase;letter-spacing:0.05em;}
    td{padding:0.6rem 0.9rem;border-bottom:1px solid var(--color-border);}
    tr:nth-child(even) td{background:#f8fafc;}
    .td-good{color:#059669;font-weight:600;font-family:var(--font-mono);}
    .td-bad{color:#dc2626;font-weight:600;font-family:var(--font-mono);}
    .td-num{font-family:var(--font-mono);}

    /* SOURCES */
    .article-source{margin-top:2.5rem;padding:1.25rem 1.5rem;border:1px solid var(--color-border);border-top:2px solid var(--color-primary);background:var(--color-surface);border-radius:0.5rem;font-size:0.8rem;color:var(--color-text-muted);}
    .article-source h4{font-size:0.72rem;text-transform:uppercase;letter-spacing:0.07em;font-weight:700;color:var(--color-text);margin-bottom:0.6rem;}
    .article-source ul{list-style:none;display:flex;flex-direction:column;gap:0.35rem;}
    .article-source li::before{content:"‚Üó  ";color:var(--color-primary);}
    .article-source a{color:var(--color-primary);text-decoration:underline;}

    /* BACK BUTTON */
    .back-btn{display:inline-flex;align-items:center;gap:0.5rem;background:var(--color-primary);color:white;text-decoration:none;padding:0.6rem 1.2rem;border-radius:0.5rem;font-weight:600;font-size:0.85rem;margin-top:2rem;transition:all 0.2s;box-shadow:var(--shadow-md);}
    .back-btn:hover{background:var(--color-primary-hover);transform:translateX(-2px);}

    /* SHARE CARD BUTTONS */
    .share-card-btn{background:var(--color-primary);color:white;border:none;padding:0.4rem 0.9rem;border-radius:0.3rem;font-size:0.75rem;font-weight:600;cursor:pointer;transition:all 0.2s;font-family:var(--font-sans);}
    .share-card-btn:hover{background:var(--color-primary-hover);transform:translateY(-1px);}
    .share-card-btn.secondary{background:transparent;border:1px solid var(--color-primary);color:var(--color-primary);}
    .share-card-btn.secondary:hover{background:var(--color-border);}

    /* TAG COLORS */
    .tag-myty    { background: #991b1b; }
    .tag-ekonomika{ background: #1d4ed8; }
    .tag-zdravi  { background: #059669; }
    .tag-inovace { background: #eab308; }
    .tag-energie { background: #4ade80; }
    .tag-bezpecnost{ background: #92400e; }
    .tag-demokracie{ background: #a855f7; }
    .tag-vyzvy   { background: #ea580c; }
    .tag-cesko   { background: #0ea5e9; }
    .tag-svet    { background: #1d4ed8; }

    /* LOADING */
    .loading{text-align:center;padding:4rem 2rem;color:var(--color-text-muted);font-size:1rem;}

    /* SHARE CARD ‚Äì v≈ædy skryt√° */
    .share-card{
      display:none !important; /* Absolutn√≠ skryt√≠ */
      width:1080px;height:1350px;
      font-family:'IBM Plex Sans',sans-serif;
      overflow:hidden;position:relative;
      flex-direction: column; 
      background: #ffffff;
    }
    .share-card-brand{background:linear-gradient(135deg,#0f172a 0%,#1e293b 60%,#1e3a5f 100%);color:white;padding:1.5rem 3rem;display:flex;align-items:center;gap:1.8rem;}
    .share-card-logo{width:110px;height:110px;flex-shrink:0;}
    .share-card-brand-right{display:flex;flex-direction:column;gap:0.6rem;}
    .share-card-brand-name{font-family:'IBM Plex Serif',serif;font-size:2.4rem;font-weight:700;color:white;line-height:1;}
    .share-card-tags{display:flex;gap:0.6rem;}
    .share-card-tag{color:white;display:inline-flex;align-items:center;justify-content:center;padding:0.45rem 1.1rem;border-radius:999px;font-size:0.85rem;font-weight:700;letter-spacing:0.06em;text-transform:uppercase;line-height:1;}

    /* data_kontext card */
    .sc-data-kontext{background:linear-gradient(135deg,#f0fdfa 0%,#ecfdf5 30%,#eff6ff 70%,#dbeafe 100%); flex-direction: column; flex: 1;}
    .sc-dk-hero{padding:2.5rem 3.5rem 2rem;}
    .sc-dk-label{font-size:1.1rem;font-weight:700;color:#0284c7;text-transform:uppercase;letter-spacing:0.15em;margin-bottom:1.2rem;display:flex;align-items:center;gap:0.6rem;}
    .sc-dk-label::before{content:'';width:10px;height:10px;background:#0ea5e9;border-radius:50%;flex-shrink:0;}
    .sc-dk-headline{font-family:'IBM Plex Serif',serif;font-size:3.3rem;font-weight:700;line-height:1.15;color:#0f172a;letter-spacing:-0.02em;}
    .sc-dk-sub{font-size:1.45rem;color:#475569;margin-top:1rem;line-height:1.4;}
    .sc-dk-data{background:rgba(255,255,255,0.7);border:2px solid rgba(14,165,233,0.25);margin:0 3.5rem;border-radius:20px;padding:2.5rem 3rem;}
    .sc-dk-data-label{font-size:1.1rem;font-weight:700;text-transform:uppercase;letter-spacing:0.12em;color:#0f172a;margin-bottom:1.8rem;border-bottom:2px solid rgba(14,165,233,0.3);padding-bottom:0.8rem;}
    .sc-stat{display:grid;grid-template-columns:230px 1fr;gap:1rem 1.5rem;align-items:start;padding:1.5rem 0;border-bottom:1px solid rgba(14,165,233,0.15);}
    .sc-stat:last-child{border-bottom:none;padding-bottom:0;}
    .sc-stat-num{font-family:'IBM Plex Mono',monospace;font-size:2.8rem;font-weight:700;line-height:1;white-space:nowrap;}
    .sc-stat-num.green{color:#059669;}
    .sc-stat-num.blue{color:#0ea5e9;}
    .sc-stat-num.purple{color:#7c3aed;}
    .sc-stat-num.red{color:#dc2626;}
    .sc-stat-label{font-size:1.25rem;color:#1e293b;line-height:1.35;font-weight:500;}
    .sc-stat-source{font-size:0.95rem;color:#64748b;margin-top:0.3rem;}
    .sc-dk-quote{background:linear-gradient(135deg,#0f172a 0%,#1e293b 100%);margin:2rem 3.5rem 0;border-radius:20px;padding:2.2rem 3rem;color:white;position:relative;overflow:hidden;}
    .sc-dk-quote::before{content:'"';position:absolute;top:-0.5rem;left:1.5rem;font-size:10rem;color:rgba(14,165,233,0.15);font-family:'IBM Plex Serif',serif;line-height:1;}
    .sc-dk-quote-text{font-family:'IBM Plex Serif',serif;font-size:1.55rem;line-height:1.45;position:relative;z-index:2;}
    .sc-dk-quote-source{font-size:1.1rem;color:#94a3b8;margin-top:1rem;position:relative;z-index:2;}
    .sc-footer{background:linear-gradient(135deg,#0f172a 0%,#1e293b 100%);color:#94a3b8;padding:1.5rem 3.5rem;font-size:1.1rem;display:flex;justify-content:space-between;align-items:center;margin-top:auto;}
    .sc-footer-url{font-size:1.5rem;font-weight:700;color:#e2e8f0;letter-spacing:0.02em;}

    /* mytus_vs_pravda card */
    .sc-mvp{background:#f8fafc; flex-direction: column; flex: 1;}
    .sc-mvp-body{padding:2.5rem 3.5rem; flex: 1; display: flex; flex-direction: column; gap: 1.5rem;}
    .sc-mvp-myth{background:linear-gradient(135deg,#fff1f2,#ffe4e6);border:2px solid #fca5a5;border-radius:16px;padding:2rem;}
    .sc-mvp-myth-label{font-size:0.9rem;font-weight:700;color:#dc2626;text-transform:uppercase;letter-spacing:0.15em;margin-bottom:1rem;display:flex;align-items:center;gap:0.5rem;}
    .sc-mvp-myth-label::before{content:'‚óè';font-size:0.7rem;}
    .sc-mvp-myth-quote{font-family:'IBM Plex Serif',serif;font-size:1.9rem;font-weight:700;line-height:1.3;color:#1e293b;font-style:italic;}
    .sc-mvp-myth-attr{font-size:0.95rem;color:#64748b;margin-top:0.8rem;}
    .sc-mvp-data{background:linear-gradient(135deg,#f0fdf4,#dcfce7);border:2px solid #86efac;border-radius:16px;padding:2rem; flex: 1;}
    .sc-mvp-data-label{font-size:0.9rem;font-weight:700;color:#059669;text-transform:uppercase;letter-spacing:0.15em;margin-bottom:1.5rem;display:flex;align-items:center;gap:0.5rem;}
    .sc-mvp-data-label::before{content:'‚óè';font-size:0.7rem;}
    .sc-mvp-stat{padding:1rem 0;border-bottom:1px solid rgba(5,150,105,0.2);}
    .sc-mvp-stat:last-child{border-bottom:none;padding-bottom:0;}
    .sc-mvp-stat-num{font-family:'IBM Plex Mono',monospace;font-size:2.6rem;font-weight:700;color:#059669;line-height:1;}
    .sc-mvp-stat-label{font-size:1.15rem;color:#1e293b;font-weight:600;margin-top:0.25rem;}
    .sc-mvp-stat-source{font-size:0.85rem;color:#64748b;font-style:italic;margin-top:0.15rem;}

    @media(max-width:768px){
      .key-stat-row{grid-template-columns:1fr;}
      h1{font-size:1.8rem;}
    }
  </style>
</head>
<body>

<header></header>

<div class="loading" id="loadingState">Naƒç√≠t√°m ƒçl√°nek‚Ä¶</div>

<article class="article-wrapper" id="articleContent" style="display:none">

  <div class="breadcrumb" id="breadcrumb" style="max-width:none; margin:0 0 1rem 0; padding:0;">
    <a href="index.html">Dom≈Ø</a>
    <span>‚Ä∫</span>
    <a href="index.html#temata">T√©mata</a>
    <span>‚Ä∫</span>
    <span id="breadcrumbTopic" style="color:var(--color-text-strong); font-weight:600;">‚Ä¶</span>
  </div>

  <div class="article-meta" id="articleMeta"></div>
  <h1 id="articleTitle"></h1>
  <p class="article-lead" id="articleLead"></p>
  <div class="key-stat-row" id="keyStats"></div>
  <div class="article-body" id="articleBody"></div>
  <div class="article-source" id="articleSources"></div>
  <a href="index.html" class="back-btn">‚Üê Zpƒõt na p≈ôehled</a>

</article>

<div class="share-card" id="shareCard"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
const TAG_LABELS = {
  'm√Ωty':       'M√Ωty vs fakta',
  'ekonomika':  'Ekonomika',
  'zdrav√≠':     'Zdrav√≠',
  'inovace':    'Inovace',
  'energie':    'Energie',
  'bezpeƒçnost': 'Bezpeƒçnost',
  'demokracie': 'Demokracie',
  'v√Ωzvy':      'V√Ωzvy',
  'ƒçesko':      'ƒåesko',
  'svƒõt':       'Svƒõt',
};
const TAG_CLASSES = {
  'm√Ωty':       'tag-myty',
  'ekonomika':  'tag-ekonomika',
  'zdrav√≠':     'tag-zdravi',
  'inovace':    'tag-inovace',
  'energie':    'tag-energie',
  'bezpeƒçnost': 'tag-bezpecnost',
  'demokracie': 'tag-demokracie',
  'v√Ωzvy':      'tag-vyzvy',
  'ƒçesko':      'tag-cesko',
  'svƒõt':       'tag-svet',
};
const TAG_COLORS_HEX = {
  'm√Ωty':       '#991b1b',
  'ekonomika':  '#1d4ed8',
  'zdrav√≠':     '#059669',
  'inovace':    '#eab308',
  'energie':    '#4ade80',
  'bezpeƒçnost': '#92400e',
  'demokracie': '#a855f7',
  'v√Ωzvy':      '#ea580c',
  'ƒçesko':      '#0ea5e9',
  'svƒõt':       '#1d4ed8',
};

const LOGO_SVG = `<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 48 48" class="share-card-logo">
  <circle cx="24" cy="24" r="21" fill="#0c1a2e"/>
  <line x1="24" y1="29" x2="7"  y2="46" stroke="#60a5fa" stroke-width="1"/>
  <line x1="24" y1="29" x2="15" y2="46" stroke="#60a5fa" stroke-width="1"/>
  <line x1="24" y1="29" x2="24" y2="46" stroke="#60a5fa" stroke-width="1.1"/>
  <line x1="24" y1="29" x2="33" y2="46" stroke="#60a5fa" stroke-width="1"/>
  <line x1="24" y1="29" x2="41" y2="46" stroke="#60a5fa" stroke-width="1"/>
  <circle cx="24" cy="24" r="21" fill="none" stroke="#60a5fa" stroke-width="1.5"/>
  <line x1="3"  y1="29" x2="45" y2="29" stroke="#60a5fa" stroke-width="1.2"/>
  <rect x="8"    y="18" width="4" height="10" rx="1" fill="#60a5fa"/>
  <rect x="15"   y="13" width="4" height="15" rx="1" fill="#60a5fa"/>
  <rect x="21.5" y="8"  width="5" height="20" rx="1.5" fill="#ffffff"/>
  <rect x="29"   y="15" width="4" height="13" rx="1" fill="#60a5fa"/>
  <rect x="36"   y="20" width="4" height="8"  rx="1"   fill="#60a5fa"/>
</svg>`;

function renderArticle(article) {
  document.title = article.title + ' | Svƒõt v perspektivƒõ';
  document.getElementById('pageTitle').textContent = article.title + ' | Svƒõt v perspektivƒõ';
  document.getElementById('breadcrumbTopic').textContent = article.title;
  document.getElementById('loadingState').style.display = 'none';
  document.getElementById('articleContent').style.display = 'block';

  const tags = article.topics.map(t =>
    `<span class="tag ${TAG_CLASSES[t] || ''}">${TAG_LABELS[t] || t}</span>`
  ).join('');
  document.getElementById('articleMeta').innerHTML = `
    ${tags}
    <span class="article-date">${article.dateStr}</span>
    <span style="margin-left:auto;display:flex;gap:0.5rem;">
      <button class="share-card-btn" onclick="downloadShareCard()">üì• St√°hnout kartiƒçku</button>
      <button class="share-card-btn secondary" onclick="shareToSocial()">üì§ Sd√≠let</button>
    </span>`;

  document.getElementById('articleTitle').textContent = article.title;
  document.getElementById('articleLead').textContent = article.perex;

  const statsHTML = article.key_stats.map(s => `
    <div class="key-stat">
      <span class="key-stat-number ${s.color || ''}">${s.value}</span>
      <span class="key-stat-label">${s.label}</span>
    </div>`).join('');
  document.getElementById('keyStats').innerHTML = statsHTML;

  document.getElementById('articleBody').innerHTML = article.content;

  const sourcesHTML = article.sources.map(s =>
    `<li><a href="${s.url}" target="_blank">${s.label}</a></li>`
  ).join('');
  document.getElementById('articleSources').innerHTML =
    `<h4>Zdroje dat</h4><ul>${sourcesHTML}</ul>`;

  renderShareCard(article);
}

function renderShareCard(article) {
  const sc = article.share_card;
  if (!sc) return;
  const card = document.getElementById('shareCard');

  const tagBadges = article.topics.map(t => {
    const col = TAG_COLORS_HEX[t] || '#64748b';
    return `<span class="share-card-tag" style="background:${col}">${(TAG_LABELS[t] || t).toUpperCase()}</span>`;
  }).join('');

  const brandStrip = `
    <div class="share-card-brand">
      ${LOGO_SVG}
      <div class="share-card-brand-right">
        <span class="share-card-brand-name">Svƒõt v perspektivƒõ</span>
        <div class="share-card-tags">${tagBadges}</div>
      </div>
    </div>`;

  const footer = `
    <div class="sc-footer">
      <div>
        <div class="sc-footer-url">svetvperspektive.cz</div>
        <div style="font-size:1rem;opacity:0.6;margin-top:0.3rem;">Data-driven zpravodajstv√≠ o glob√°ln√≠m pokroku.</div>
      </div>
      <span style="font-size:1.1rem;opacity:0.6;">√önor 2026</span>
    </div>`;

  if (sc.type === 'data_kontext') {
    const statsHTML = sc.stats.map(s => `
      <div class="sc-stat">
        <div class="sc-stat-num ${s.color || 'green'}">${s.value}</div>
        <div>
          <div class="sc-stat-label">${s.label}</div>
          <div class="sc-stat-source">${s.source_text}</div>
        </div>
      </div>`).join('');

    card.className = 'share-card sc-data-kontext';
    card.innerHTML = `${brandStrip}<div class="sc-dk-hero"><div class="sc-dk-label">DATA &amp; KONTEXT</div><div class="sc-dk-headline">${sc.headline_text}</div><div class="sc-dk-sub">${sc.headline_sub}</div></div><div class="sc-dk-data"><div class="sc-dk-data-label">CO ≈ò√çKAJ√ç DATA</div>${statsHTML}</div>${sc.quote_text ? `<div class="sc-dk-quote"><div class="sc-dk-quote-text">${sc.quote_text}</div><div class="sc-dk-quote-source">${sc.quote_source}</div></div>` : ''}${footer}`;

  } else if (sc.type === 'mytus_vs_pravda') {
    const statsHTML = sc.stats.map(s => `
      <div class="sc-mvp-stat">
        <div class="sc-mvp-stat-num">${s.value}</div>
        <div class="sc-mvp-stat-label">${s.label}</div>
        <div class="sc-mvp-stat-source">${s.source_text}</div>
      </div>`).join('');

    card.className = 'share-card sc-mvp';
    card.innerHTML = `${brandStrip}<div class="sc-mvp-body"><div class="sc-mvp-myth"><div class="sc-mvp-myth-label">TVRZEN√ç K OVƒö≈òEN√ç</div><div class="sc-mvp-myth-quote">${sc.myth_quote}</div><div class="sc-mvp-myth-attr">${sc.myth_attribution}</div></div><div class="sc-mvp-data"><div class="sc-mvp-data-label">CO ≈ò√çKAJ√ç DATA</div>${statsHTML}</div></div>${footer}`;
  }
}

let isGenerating = false;
async function downloadShareCard() {
  if (isGenerating) return;
  isGenerating = true;
  const card = document.getElementById('shareCard');
  const btn = document.querySelector('.share-card-btn');
  btn.disabled = true;
  btn.textContent = '‚è≥ Generuji‚Ä¶';

  card.style.setProperty('display', 'flex', 'important');
  card.style.position = 'absolute';
  card.style.left = '-9999px';

  try {
    await document.fonts.ready;
    await new Promise(r => setTimeout(r, 600));
    const canvas = await html2canvas(card, { width: 1080, height: 1350, scale: 2, useCORS: true });
    card.style.setProperty('display', 'none', 'important');
    canvas.toBlob(blob => {
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = (window._articleData && window._articleData.share_card && window._articleData.share_card.download_filename) || 'svet-v-perspektive.png';
      document.body.appendChild(a); a.click();
      setTimeout(() => { document.body.removeChild(a); URL.revokeObjectURL(url); }, 100);
      btn.disabled = false; btn.textContent = '‚úÖ Sta≈æeno!';
      isGenerating = false;
      setTimeout(() => { btn.textContent = 'üì• St√°hnout kartiƒçku'; }, 2500);
    }, 'image/png');
  } catch(err) {
    card.style.setProperty('display', 'none', 'important');
    btn.disabled = false; btn.textContent = '‚ùå Chyba';
    isGenerating = false;
    setTimeout(() => { btn.textContent = 'üì• St√°hnout kartiƒçku'; }, 3000);
  }
}

function shareToSocial() {
  alert('üí° TIP: St√°hnƒõte kartiƒçku a pak ji nahrajte na Instagram/Facebook/Twitter!');
}

(async function () {
  const params = new URLSearchParams(window.location.search);
  let slug = params.get('slug');
  if (!slug) {
    const pathParts = window.location.pathname.split('/');
    const articlesIdx = pathParts.indexOf('articles');
    if (articlesIdx !== -1 && pathParts[articlesIdx + 1]) slug = pathParts[articlesIdx + 1];
  }
  if (!slug) {
    document.getElementById('loadingState').textContent = 'Chyb√≠ parametr slug v URL';
    return;
  }
  try {
    const rootPath = window.location.pathname.includes('/articles/') ? '../' : '';
    const res = await fetch(`${rootPath}articles/${slug}.json`);
    if (!res.ok) throw new Error('ƒål√°nek nenalezen');
    const article = await res.json();
    window._articleData = article;
    renderArticle(article);
  } catch (err) {
    document.getElementById('loadingState').innerHTML = `<strong>ƒål√°nek nenalezen.</strong>`;
  }
})();
</script>

<footer></footer>
<script src="components.js"></script>
</body>
</html>
